# Database
spring.datasource.url=jdbc:mysql://mysql:3306/laws?useUnicode=true&characterEncoding=utf8&serverTimezone=UTC
spring.datasource.username=app
spring.datasource.password=app

# JPA & Flyway
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration/social
spring.flyway.table=flyway_schema_history_social
spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=0

# Server
server.port=8082
app.cors.allowed-origins=http://localhost:5173,http://127.0.0.1:5173,http://localhost:5174,http://127.0.0.1:5174,http://localhost:3000,http://127.0.0.1:3000,http://localhost:8080,http://127.0.0.1:8080
app.otp.ttl-seconds=600
app.otp.log-key=true
app.otp.debug-enabled=true
# Set to true to keep OTP keys without expiry (for local debugging only)
app.otp.dev-no-expire=false
app.jwt.secret=cthanhdeptrai
app.jwt.ttl-seconds=3600

# Mail configuration used by OTP flows
app.mail.host=${MAIL_HOST:smtp.gmail.com}
app.mail.port=${MAIL_PORT:587}
app.mail.username=${MAIL_USERNAME:otp@vn-law.dev}
app.mail.password=${MAIL_PASSWORD:changeme}
app.mail.from=${MAIL_FROM:otp@vn-law.dev}
app.mail.from-name=${MAIL_FROM_NAME:VNLaw OTP}
app.mail.properties.mail.smtp.auth=${MAIL_SMTP_AUTH:true}
app.mail.properties.mail.smtp.starttls.enable=${MAIL_SMTP_STARTTLS:true}

# Redis (docker compose)
spring.data.redis.host=redis
spring.data.redis.port=6379
spring.data.redis.database=0

# Cache: dung in-memory de tranh serialize OffsetDateTime khi ghi Redis cache
spring.cache.type=simple
spring.cache.cache-names=myPosts,userPosts,publicFeed

# Reset post data khi container start lai (xoa DB posts + uploads)
app.posts.reset-on-start=true

# Media storage (Cloudinary by default, fallback to local uploads when MEDIA_STORAGE=local)
app.media.storage=${MEDIA_STORAGE:cloudinary}
app.media.upload-dir=uploads
app.media.public-prefix=/media
app.media.cloud.folder=${CLOUDINARY_FOLDER:vn-law/social}
cloudinary.cloud-name=${CLOUDINARY_CLOUD_NAME:}
cloudinary.api-key=${CLOUDINARY_API_KEY:}
cloudinary.api-secret=${CLOUDINARY_API_SECRET:}
